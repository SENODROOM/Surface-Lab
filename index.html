<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="Logo/icon.png" type="image/x-icon">
    <title>GraphSpace - Advanced 3D Surface Explorer</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="app-container">
        <!-- Left Sidebar -->
        <div class="sidebar sidebar-left">
            <!-- Header -->
            <div class="sidebar-header">
                <div class="logo">
                    <div class="logo-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 3v18h18" />
                            <path d="M7 16c2-2 4-4 6-2s4 2 6-2" />
                        </svg>
                    </div>
                    <div class="logo-text">
                        <div class="logo-title">GraphSpace</div>
                        <div class="logo-subtitle">3D Surface Explorer</div>
                    </div>
                </div>
                <button class="btn-icon" onclick="addEquation()" title="Add Equation">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                </button>
            </div>

            <!-- Equations List -->
            <div class="equations-container" id="equations-container">
                <!-- Equations will be dynamically added here -->
            </div>

            <!-- Function Keyboard -->
            <div class="section keyboard-section collapsed">
                <button class="section-toggle" onclick="toggleKeyboard()">
                    <span>‚å®Ô∏è Function Keyboard</span>
                    <svg class="toggle-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="6 9 12 15 18 9"></polyline>
                    </svg>
                </button>
                <div class="keyboard-content" id="keyboard-content">
                    <div class="keyboard-grid">
                        <button class="key-btn" onclick="insertAtActive('‚àö()', 2)">‚àö</button>
                        <button class="key-btn" onclick="insertAtActive('^2', 2)">x¬≤</button>
                        <button class="key-btn" onclick="insertAtActive('^3', 2)">x¬≥</button>
                        <button class="key-btn" onclick="insertAtActive('^', 1)">x‚Åø</button>
                        <button class="key-btn" onclick="insertAtActive('sin()', 1)">sin</button>
                        <button class="key-btn" onclick="insertAtActive('cos()', 1)">cos</button>
                        <button class="key-btn" onclick="insertAtActive('tan()', 1)">tan</button>
                        <button class="key-btn" onclick="insertAtActive('exp()', 1)">eÀ£</button>
                        <button class="key-btn" onclick="insertAtActive('ln()', 1)">ln</button>
                        <button class="key-btn" onclick="insertAtActive('abs()', 1)">|x|</button>
                        <button class="key-btn" onclick="insertAtActive('œÄ')">œÄ</button>
                        <button class="key-btn" onclick="insertAtActive('e')">e</button>
                    </div>
                </div>
            </div>

            <!-- Settings -->
            <div class="section collapsed">
                <button class="section-toggle" onclick="toggleSection('settings')">
                    <span>‚öôÔ∏è Settings</span>
                    <svg class="toggle-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="6 9 12 15 18 9"></polyline>
                    </svg>
                </button>
                <div class="section-content" id="settings-content">
                    <div class="setting-group">
                        <label>Domain Range</label>
                        <div class="range-inputs">
                            <div class="range-input-group">
                                <span class="range-label">X:</span>
                                <input type="number" id="xmin" value="-5" step="0.5">
                                <span class="range-separator">to</span>
                                <input type="number" id="xmax" value="5" step="0.5">
                            </div>
                            <div class="range-input-group">
                                <span class="range-label">Y:</span>
                                <input type="number" id="ymin" value="-5" step="0.5">
                                <span class="range-separator">to</span>
                                <input type="number" id="ymax" value="5" step="0.5">
                            </div>
                        </div>
                    </div>

                    <div class="setting-group">
                        <label>Axis Orientation</label>
                        <select id="axis-orientation" class="select-input" onchange="changeAxisOrientation()">
                            <option value="y-up">Y-Axis Up (Standard)</option>
                            <option value="z-up">Z-Axis Up (Alternative)</option>
                        </select>
                    </div>

                    <div class="setting-group">
                        <div class="slider-label">
                            <span>Resolution</span>
                            <span class="slider-value" id="res-value">50</span>
                        </div>
                        <input type="range" id="resolution" min="20" max="100" value="50" step="5">
                    </div>

                    <div class="setting-group">
                        <label>Actions</label>
                        <div class="action-buttons">
                            <button class="btn-secondary" onclick="resetCamera()">Reset View</button>
                            <button class="btn-secondary" onclick="toggleGrid()">Toggle Grid</button>
                            <button class="btn-secondary" onclick="toggleAxes()">Toggle Axes</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Presets -->
            <div class="section collapsed" style="margin-bottom: 90px;">
                <button class="section-toggle" onclick="toggleSection('presets')">
                    <span>‚ö° Presets</span>
                    <svg class="toggle-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="6 9 12 15 18 9"></polyline>
                    </svg>
                </button>
                <div class="section-content" id="presets-content" style="padding-top: 5px;">
                    <div class="presets-grid">
                        <button class="preset-card" onclick="loadPreset('sin(‚àö(x¬≤+y¬≤))', '#6366f1')">
                            <div class="preset-name">Ripple Wave</div>
                            <div class="preset-equation">sin(‚àö(x¬≤+y¬≤))</div>
                        </button>
                        <button class="preset-card" onclick="loadPreset('x¬≤+y¬≤', '#ec4899')">
                            <div class="preset-name">Paraboloid</div>
                            <div class="preset-equation">x¬≤+y¬≤</div>
                        </button>
                        <button class="preset-card" onclick="loadPreset('x¬≤-y¬≤', '#8b5cf6')">
                            <div class="preset-name">Saddle</div>
                            <div class="preset-equation">x¬≤-y¬≤</div>
                        </button>
                        <button class="preset-card" onclick="loadPreset('sin(x)cos(y)', '#10b981')">
                            <div class="preset-name">Wave Grid</div>
                            <div class="preset-equation">sin(x)cos(y)</div>
                        </button>
                        <button class="preset-card" onclick="loadPreset('sin(x)/x*sin(y)/y', '#f59e0b')">
                            <div class="preset-name">Sinc Function</div>
                            <div class="preset-equation">sin(x)/x¬∑sin(y)/y</div>
                        </button>
                        <button class="preset-card" onclick="loadPreset('exp(-(x¬≤+y¬≤))', '#06b6d4')">
                            <div class="preset-name">Gaussian</div>
                            <div class="preset-equation">e^(-(x¬≤+y¬≤))</div>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Canvas Area -->
        <div class="canvas-area">
            <div class="canvas-header">
                <div class="canvas-info">
                    <div class="info-badge">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"></circle>
                            <line x1="12" y1="8" x2="12" y2="12"></line>
                            <line x1="12" y1="16" x2="12.01" y2="16"></line>
                        </svg>
                        <span>Drag to rotate ‚Ä¢ Shift+Drag to pan ‚Ä¢ Scroll to zoom</span>
                    </div>
                </div>
                <div class="canvas-stats">
                    <div class="stat-badge">
                        <span class="stat-label">Surfaces:</span>
                        <span class="stat-value" id="stat-surfaces">0</span>
                    </div>
                    <div class="stat-badge">
                        <span class="stat-label">Points:</span>
                        <span class="stat-value" id="stat-points">0</span>
                    </div>
                    <button class="btn-icon-header" onclick="toggleRightPanel()" title="Toggle Analysis Panel">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="9" y1="3" x2="9" y2="21"></line>
                        </svg>
                    </button>
                </div>
            </div>
            <canvas id="canvas3d"></canvas>
        </div>

        <!-- Right Sidebar (Analysis Panel) -->
        <div class="sidebar sidebar-right" id="right-panel">
            <div class="sidebar-header">
                <div class="panel-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                    </svg>
                    <span>Analysis & Visualization</span>
                </div>
            </div>

            <div class="right-panel-content">
                <!-- Surface Analysis -->
                <div class="section">
                    <button class="section-toggle" onclick="toggleSection('analysis')">
                        <span>üìä Surface Analysis</span>
                        <svg class="toggle-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </button>
                    <div class="section-content" id="analysis-content">
                        <div class="analysis-controls">
                            <label class="checkbox-label">
                                <input type="checkbox" id="show-critical-points" onchange="toggleCriticalPoints()">
                                <span>Show Critical Points</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="show-contours" onchange="toggleContours()">
                                <span>Show Contour Lines</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="show-normals" onchange="toggleNormals()">
                                <span>Show Normal Vectors</span>
                            </label>
                        </div>
                        <div class="analysis-results" id="analysis-results">
                            <div class="analysis-card">
                                <div class="analysis-label">Surface Area (approx)</div>
                                <div class="analysis-value" id="surface-area">‚Äî</div>
                            </div>
                            <div class="analysis-card">
                                <div class="analysis-label">Volume Under Surface</div>
                                <div class="analysis-value" id="surface-volume">‚Äî</div>
                            </div>
                            <div class="analysis-card">
                                <div class="analysis-label">Min/Max Z-Value</div>
                                <div class="analysis-value" id="z-range">‚Äî</div>
                            </div>
                        </div>
                        <button class="btn-primary" onclick="analyzeSurface()">Analyze Active Surface</button>
                    </div>
                </div>

                <!-- Visualization Mode -->
                <div class="section">
                    <button class="section-toggle" onclick="toggleSection('visualization')">
                        <span>üé® Visualization</span>
                        <svg class="toggle-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </button>
                    <div class="section-content" id="visualization-content">
                        <div class="setting-group">
                            <label>Render Mode</label>
                            <select id="render-mode" class="select-input" onchange="changeRenderMode()">
                                <option value="solid">Solid</option>
                                <option value="wireframe">Wireframe</option>
                                <option value="points">Points</option>
                            </select>
                        </div>
                        <div class="setting-group">
                            <label>Color Mode</label>
                            <select id="color-mode" class="select-input" onchange="changeColorMode()">
                                <option value="solid">Solid Color</option>
                                <option value="height">Height Gradient</option>
                                <option value="slope">Slope</option>
                            </select>
                        </div>
                        <div class="setting-group">
                            <div class="slider-label">
                                <span>Opacity</span>
                                <span class="slider-value" id="opacity-value">100%</span>
                            </div>
                            <input type="range" id="surface-opacity" min="10" max="100" value="100" step="5" oninput="changeSurfaceOpacity()">
                        </div>
                        <div class="setting-group">
                            <div class="slider-label">
                                <span>Shininess</span>
                                <span class="slider-value" id="shininess-value">30</span>
                            </div>
                            <input type="range" id="surface-shininess" min="0" max="100" value="30" step="5" oninput="changeSurfaceShininess()">
                        </div>
                        <div class="setting-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="smooth-shading" checked onchange="toggleSmoothShading()">
                                <span>Smooth Shading</span>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Auto Rotation -->
                <div class="section">
                    <button class="section-toggle" onclick="toggleSection('rotation')">
                        <span>üîÑ Auto Rotation</span>
                        <svg class="toggle-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </button>
                    <div class="section-content" id="rotation-content">
                        <label class="checkbox-label">
                            <input type="checkbox" id="auto-rotate" onchange="toggleAutoRotate()">
                            <span>Enable Auto Rotation</span>
                        </label>
                        <div class="setting-group">
                            <div class="slider-label">
                                <span>Speed</span>
                                <span class="slider-value" id="rotation-speed-value">1.0x</span>
                            </div>
                            <input type="range" id="rotation-speed" min="1" max="20" value="5" step="1">
                        </div>
                    </div>
                </div>

                <!-- Animation -->
                <div class="section">
                    <button class="section-toggle" onclick="toggleSection('animation')">
                        <span>‚ñ∂Ô∏è Animation</span>
                        <svg class="toggle-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </button>
                    <div class="section-content" id="animation-content">
                        <div class="setting-group">
                            <label>Animation Type</label>
                            <select id="animation-type" class="select-input">
                                <option value="none">None</option>
                                <option value="wave">Wave Motion</option>
                                <option value="pulse">Pulse</option>
                                <option value="morph">Morph</option>
                            </select>
                        </div>
                        <div class="animation-buttons">
                            <button class="btn-secondary" onclick="startAnimation()">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polygon points="5 3 19 12 5 21 5 3"></polygon>
                                </svg>
                                Start
                            </button>
                            <button class="btn-secondary" onclick="stopAnimation()">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="6" y="4" width="4" height="16"></rect>
                                    <rect x="14" y="4" width="4" height="16"></rect>
                                </svg>
                                Pause
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Point Evaluation -->
                <div class="section">
                    <button class="section-toggle" onclick="toggleSection('evaluation')">
                        <span>üìç Point Evaluation</span>
                        <svg class="toggle-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </button>
                    <div class="section-content" id="evaluation-content">
                        <div class="eval-inputs">
                            <div class="eval-input-group">
                                <label>X:</label>
                                <input type="number" id="eval-x" value="0" step="0.1">
                            </div>
                            <div class="eval-input-group">
                                <label>Y:</label>
                                <input type="number" id="eval-y" value="0" step="0.1">
                            </div>
                        </div>
                        <button class="btn-primary" onclick="evaluatePoint()">Evaluate Point</button>
                        <div class="eval-result" id="eval-result">
                            <div class="eval-result-label">Result:</div>
                            <div class="eval-result-value" id="eval-z-value">‚Äî</div>
                        </div>
                        <label class="checkbox-label">
                            <input type="checkbox" id="show-marker" onchange="toggleMarker()">
                            <span>Show Point Marker</span>
                        </label>
                    </div>
                </div>

                <!-- Export Options -->
                <div class="section">
                    <button class="section-toggle" onclick="toggleSection('export')">
                        <span>üíæ Export</span>
                        <svg class="toggle-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </button>
                    <div class="section-content" id="export-content">
                        <div class="export-buttons">
                            <button class="btn-export" onclick="exportScreenshot()">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                                    <circle cx="8.5" cy="8.5" r="1.5"></circle>
                                    <polyline points="21 15 16 10 5 21"></polyline>
                                </svg>
                                <span>Screenshot (PNG)</span>
                            </button>
                            <button class="btn-export" onclick="exportSTL()">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
                                </svg>
                                <span>3D Model (STL)</span>
                            </button>
                            <button class="btn-export" onclick="exportData()">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                    <polyline points="14 2 14 8 20 8"></polyline>
                                    <line x1="12" y1="18" x2="12" y2="12"></line>
                                    <line x1="9" y1="15" x2="15" y2="15"></line>
                                </svg>
                                <span>Data (CSV)</span>
                            </button>
                            <button class="btn-export" onclick="exportEquations()">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                    <polyline points="14 2 14 8 20 8"></polyline>
                                    <line x1="16" y1="13" x2="8" y2="13"></line>
                                    <line x1="16" y1="17" x2="8" y2="17"></line>
                                    <polyline points="10 9 9 9 8 9"></polyline>
                                </svg>
                                <span>Equations (JSON)</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Camera Presets -->
                <div class="section" style="margin-bottom: 20px;">
                    <button class="section-toggle" onclick="toggleSection('camera')">
                        <span>üì∑ Camera Presets</span>
                        <svg class="toggle-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </button>
                    <div class="section-content" id="camera-content">
                        <div class="camera-presets">
                            <button class="btn-camera" onclick="setCameraView('front')">Front View</button>
                            <button class="btn-camera" onclick="setCameraView('back')">Back View</button>
                            <button class="btn-camera" onclick="setCameraView('top')">Top View</button>
                            <button class="btn-camera" onclick="setCameraView('bottom')">Bottom View</button>
                            <button class="btn-camera" onclick="setCameraView('left')">Left View</button>
                            <button class="btn-camera" onclick="setCameraView('right')">Right View</button>
                            <button class="btn-camera" onclick="setCameraView('isometric')">Isometric</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Autocomplete Dropdown (shared) -->
    <div class="autocomplete-dropdown" id="autocomplete"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="script.js"></script>
</body>

</html>
